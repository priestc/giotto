

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started with Giotto &mdash; Giotto 0.0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Giotto 0.0.2 documentation" href="index.html" />
    <link rel="next" title="Terminology" href="terminology.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="terminology.html" title="Terminology"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Giotto 0.0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started-with-giotto">
<span id="ref-tutorial"></span><h1>Getting Started with Giotto<a class="headerlink" href="#getting-started-with-giotto" title="Permalink to this headline">¶</a></h1>
<p>First, install giotto:</p>
<div class="highlight-python"><pre>$ pip install giotto</pre>
</div>
<p>Now create a new directory:</p>
<div class="highlight-python"><pre>$ mkdir demo</pre>
</div>
<p>and inside that directory, run this command:</p>
<div class="highlight-python"><pre>$ cd demo
$ giotto_project --http --cmd --demo</pre>
</div>
<p>This will create a <tt class="docutils literal"><span class="pre">programs.py</span></tt> file, which contains your program objects.
It will also create a series of &#8220;concrete controller files&#8221;,
which will act as a gateway between your application and the outside world.
The concrete controller files will be called <tt class="docutils literal"><span class="pre">giotto-http</span></tt> and <tt class="docutils literal"><span class="pre">giotto-cmd</span></tt></p>
<p>If you only want to interact with you application through the command line,
then you could leave off the <tt class="docutils literal"><span class="pre">--http</span></tt> flag when calling <tt class="docutils literal"><span class="pre">giotto_project</span></tt> (and vice versa).
The option <tt class="docutils literal"><span class="pre">--demo</span></tt> tells giotto to include a simple &#8220;multiply&#8221; program to demonstrate how giotto works.</p>
<p>Inside the <tt class="docutils literal"><span class="pre">programs.py</span></tt> file, you will see the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ColoredMultiplyView</span><span class="p">(</span><span class="n">GiottoTemplateView</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">text_plain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{{ obj.x }} * {{ obj.y }} == {{ obj.product }}&quot;</span>

    <span class="k">def</span> <span class="nf">application_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">json</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">text_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s">        &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s">        &lt;html&gt;</span>
<span class="s">            &lt;body&gt;</span>
<span class="s">                &lt;span style=&quot;color: blue&quot;&gt;{{ obj.x }} * {{ obj.y }}&lt;/span&gt; ==</span>
<span class="s">                &lt;span style=&quot;color: red&quot;&gt;{{ obj.product }}&lt;/span&gt;</span>
<span class="s">            &lt;/body&gt;</span>
<span class="s">        &lt;/html&gt;&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">text_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">colorama</span> <span class="kn">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">Fore</span>
        <span class="n">init</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">&quot;{blue}{x} * {y}{reset} == {red}{product}{reset}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">blue</span><span class="o">=</span><span class="n">Fore</span><span class="o">.</span><span class="n">BLUE</span><span class="p">,</span>
            <span class="n">red</span><span class="o">=</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span>
            <span class="n">reset</span><span class="o">=</span><span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span>
            <span class="n">product</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;product&#39;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">text_irc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{blue}{x} * {y}{reset} == {red}{product}{reset}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">blue</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\x03</span><span class="s">02&quot;</span><span class="p">,</span>
            <span class="n">red</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\x03</span><span class="s">04&quot;</span><span class="p">,</span>
            <span class="n">reset</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\x03</span><span class="s">&quot;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span>
            <span class="n">product</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;product&#39;</span><span class="p">],</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s">&#39;product&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)}</span>


<span class="k">class</span> <span class="nc">Multiply</span><span class="p">(</span><span class="n">GiottoProgram</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;multiply&quot;</span>
    <span class="n">controllers</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;http-get&#39;</span><span class="p">,</span> <span class="s">&#39;cmd&#39;</span><span class="p">,</span> <span class="s">&#39;irc&#39;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiply</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;product&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}]</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">ColoredMultiplyView</span>
</pre></div>
</div>
<p>All Giotto applications are made up a collection of Giotto Programs. Each program class
defines a model, a view, and a set of controllers.</p>
<p>A &#8220;Giotto application&#8221; is the overall project,
such as a blog application, a content management system, or a twitter clone.
A &#8220;Giotto Program&#8221; is a &#8220;page&#8221; within an application.
An example of a program is &#8220;create blog&#8221;, &#8220;view tweet&#8221; or &#8220;register user&#8221;.</p>
<p>A Giotto program is made up of (at minimum) a model, a view, and a set of controllers.
In the above example, our application only contains one program called &#8220;mutiply&#8221;.
All it does is take two numbers, and multiply them together.</p>
<p>To see our example <tt class="docutils literal"><span class="pre">multiply</span></tt> program in action,
start up the development server by running the following command:</p>
<div class="highlight-python"><pre>$ giotto-http --run</pre>
</div>
<p>This will run the development server (you must have werkzeug installed).
Point your browser to: <a class="reference external" href="http://localhost:5000/multiply?x=4&amp;y=8">http://localhost:5000/multiply?x=4&amp;y=8</a></p>
<p>The browser should now be displaying <cite>4 * 8 == 32</cite>. With the part before the <cite>==</cite>
in blue, and the part after in red.</p>
<p>The following order of events are occurring:</p>
<ol class="arabic">
<li><p class="first">You make a web request to the development server that is hooked up to our demo application, with the help of Giotto.</p>
</li>
<li><p class="first">HTTP request is received by Giotto.</p>
</li>
<li><p class="first">Giotto inspects the request and dispatches the request off to the <tt class="docutils literal"><span class="pre">Multiply</span></tt> program.
Giotto knows to dispatch the request to the Multiply program
because:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>The program is configured to use the &#8216;http-get&#8217; controller, and this is a HTTP GET request.</li>
<li>The url matches the <tt class="docutils literal"><span class="pre">name</span></tt> attribute on the program class.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">Calls the model with the arguments from the GET vars.</p>
</li>
<li><p class="first">Takes the output from the model and passes it into the view object.</p>
</li>
<li><p class="first">Calls the appropriate rendering method on the view class, depending on (in this case) the <tt class="docutils literal"><span class="pre">Accept</span></tt> headers.</p>
</li>
</ol>
<p>Now, open up your browser&#8217;s javascript console (firebug if you&#8217;re a firefox user).
Type in the following:</p>
<div class="highlight-python"><pre>$.ajax({url: window.location.href, success: function(a) {console.log(a)}})</pre>
</div>
<p>You should see a json representation of the page. The HTTP controller automatically
changes the return mimetype to &#8220;application/json&#8221; when the request comes from
ajax.</p>
<p>Lets take a look at this program as viewed from the command line. Press <cite>ctrl+c</cite>
to stop the dev server.</p>
<p>Form the shell, run the following command:</p>
<div class="highlight-python"><pre>$ giotto-cmd multiply x=4 y=8</pre>
</div>
<p>The output should be exactly the same. It should say <cite>4 * 8 == 32</cite> with the <cite>32</cite>
in red and the <cite>4 * 8</cite> in blue.</p>
<p>The model that is being called here is exactly the same as we saw being called from the browser.
The only difference is the way the result is visualized,
and the data moves between the user and the computer through the command lone, instead of a browser..</p>
<div class="section" id="using-mocks">
<h2>Using Mocks<a class="headerlink" href="#using-mocks" title="Permalink to this headline">¶</a></h2>
<p>On the GiottoProgram class, add a <tt class="docutils literal"><span class="pre">model_mock</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Multiply</span><span class="p">(</span><span class="n">GiottoProgram</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;multiply&quot;</span>
    <span class="n">controllers</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;http-get&#39;</span><span class="p">,</span> <span class="s">&#39;cmd&#39;</span><span class="p">,</span> <span class="s">&#39;irc&#39;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiply</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;product&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}]</span>
    <span class="n">view</span> <span class="o">=</span> <span class="p">[</span><span class="n">ColoredMultiplyView</span><span class="p">]</span>
</pre></div>
</div>
<p>When you run the dev server include the <tt class="docutils literal"><span class="pre">--model-mock</span></tt> flag:</p>
<div class="highlight-python"><pre>$ giotto-http --run --model-mock</pre>
</div>
<p>Now no matter what arguments you place in the url, the output will always be <tt class="docutils literal"><span class="pre">10</span> <span class="pre">*</span> <span class="pre">10</span> <span class="pre">==</span> <span class="pre">100</span></tt>.
If your model makes calls to the database or third party service,
the <tt class="docutils literal"><span class="pre">model-mock</span></tt> option will bypass all of that.
This feature is useful for front end designers who do not need to run the full model stack in order to create HTML templates.</p>
</div>
<div class="section" id="cache">
<h2>Cache<a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h2>
<p>Add a <tt class="docutils literal"><span class="pre">cache</span></tt> attribute to the program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Multiply</span><span class="p">(</span><span class="n">GiottoProgram</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;multiply&quot;</span>
    <span class="n">controllers</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;http-get&#39;</span><span class="p">,</span> <span class="s">&#39;cmd&#39;</span><span class="p">,</span> <span class="s">&#39;irc&#39;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiply</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;product&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}]</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="mi">3600</span>
    <span class="n">view</span> <span class="o">=</span> <span class="p">[</span><span class="n">ColoredMultiplyView</span><span class="p">]</span>
</pre></div>
</div>
<p>Restart the cache server (this time leave off the <tt class="docutils literal"><span class="pre">--model-mock</span></tt> flag).
Also, add a pause to the model method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">time</span><span class="p">;</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s">&#39;product&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)}</span>
</pre></div>
</div>
<p>This will simulate a heavy calculating model.
You also need to have either Redis or Memcache installed and running.
Configure the cache by adding the following to the <tt class="docutils literal"><span class="pre">cache</span></tt> variable in the concrete controller file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">giotto.cache</span> <span class="kn">import</span> <span class="n">CacheWithMemcache</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">CacheWithMemcache</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s">&#39;localhost&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To use the redis cache, change the class to <tt class="docutils literal"><span class="pre">CacheWithRedis</span></tt>.
Now when you load a page, it will take 5 seconds for the first render,
and subsequent renders will be served from cache.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started with Giotto</a><ul>
<li><a class="reference internal" href="#using-mocks">Using Mocks</a></li>
<li><a class="reference internal" href="#cache">Cache</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="terminology.html"
                        title="next chapter">Terminology</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="terminology.html" title="Terminology"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="index.html">Giotto 0.0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Chris Priest.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>